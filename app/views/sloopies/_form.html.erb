<div class="sloopie-page">
  <%= simple_form_for(sloopy) do |f| %>
    <%= f.error_notification %>

    <div class="sloopie-form-wrapper">
      <div class="sloopie-form-container">
        <form class="form-inline">

          <div class="sloopie-form-row">
            <div class="sloopie-input-group">
              <%= f.input :origin,
                  label: false,
                  placeholder: "Choose your origin city",
                  input_html: { class: "sloopie-form-control"},
                  required: false %>
            </div>

            <div class="sloopie-input-group">
              <%= f.input :destination,
                  label: false,
                  placeholder: "Choose your destination city",
                  input_html: { class: "sloopie-form-control" },
                  required: false %>
            </div>

            <div class="sloopie-input-group">
              <%= f.input :duration,
                  label: false,
                  placeholder: "Duration at destination",
                  input_html: { class: "sloopie-form-control mb-0"},
                  required: false %>
            </div>
          </div>

          <div class="sloopie-input-group">
            <div class="mb-3">
              <%= f.input :departure_date,
                  as: :string,
                  label: false,
                  placeholder: "Choose your dates trip",
                  input_html: {
                    class: "sloopie-form-control",
                    data: {
                      controller: "datepicker",
                      datepicker_target: "range"
                    }
                  } %>
            </div>
          </div>

          <!-- Remplacer l'input du Budget par un range avec affichage au-dessus -->
          <div class="sloopie-form-row">
            <div class="sloopie-input-group">
              <label for="budget" class="label-style mb-2">Transport Budget</label>
              <div class="range-wrapper d-flex justify-content-center position-relative">
                <input type="range"
                       class="form-range mb-5"
                       id="budget"
                       name="sloopy[budget]"
                       min="0"
                       max="1500"
                       step="1"
                       value="<%= sloopy.budget %>">
                <span id="budget-value" class="range-value price-value position-absolute">
                  <%= sloopy.budget %>€
                </span>
              </div>
            </div>
          </div>

        </form>
      </div>

      <div class="sloopie-form-container-bis">
        <div class="sloopie-form-actions d-flex justify-content-center btn-new-sloopes btn">
          <%= f.button :submit, "Generate your Sloopies" %>
        </div>
      </div>
    </div>
  <% end %>
</div>

<!-- Script pour gérer l'affichage dynamique de la valeur au-dessus du curseur -->
<script>
  const budgetSlider = document.getElementById('budget');
  const budgetValue = document.getElementById('budget-value');

  // Fonction pour mettre à jour la valeur du budget et la position du texte
  function updateBudgetValue() {
    const value = budgetSlider.value;
    budgetValue.textContent = `${value}€`;

    // Calculer la position du curseur
    const position = (value - budgetSlider.min) / (budgetSlider.max - budgetSlider.min) * 100;
    budgetValue.style.left = `calc(${position}% - 35px)`; // Ajuster le décalage pour centrer la valeur
  }

  // Appel de la fonction lors du changement de valeur du slider
  budgetSlider.addEventListener('input', updateBudgetValue);

  // Appel initial pour positionner correctement la valeur au chargement de la page
  updateBudgetValue();
</script>
